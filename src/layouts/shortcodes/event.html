<!--
Put this file in /layouts/shortcodes/figure.html
NB this overrides Hugo's built-in "figure" shortcode but is backwards compatible
Documentation and licence at https://github.com/liwenyip/hugo-easy-gallery/
-->
<!-- count how many times we've called this shortcode; load the css if it's the first time -->
{{- if not ($.Page.Scratch.Get "figurecount") }}<link rel="stylesheet" href="/css/hugo-easy-gallery.css" />{{ end }}
{{- $.Page.Scratch.Add "figurecount" 1 -}}
<!-- use either src or link-thumb for thumbnail image -->

<div class="box" style="width:{{ .Get "width" | default "20%" }};padding-bottom:{{ .Get "width" | default "20%" }};">
  <figure itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
    <div class="img" style="background-image: url('/events/images/{{ .Get "image" | default (printf "%s.jpg" (.Get "slug")) }}');"{{ with .Get "size" }} data-size="{{.}}"{{ end }}></div>
    {{- if or (.Get "title") (.Get "slug") }}
    <figcaption class="topcaption">
      {{- with .Get "title" | default (.Get "slug") }}<h4>{{.}}</h4>{{ end }}
    </figcaption>
    {{ end }}

    {{ with .Get "link" | default (.Get "src") }}<a href="{{.}}" itemprop="contentUrl"></a>{{ end }}

    {{- if or (.Get "recordings") (.Get "slug") }}
      <figcaption class="bottomcaption">
          <p>
            <a href="{{ .Get "recordings" | default (printf "https://media.ccc.de/c/%s" (.Get "slug")) }}">Recordings</a>
          </p>
      </figcaption>
    {{- end }}
  </figure>
</div>
